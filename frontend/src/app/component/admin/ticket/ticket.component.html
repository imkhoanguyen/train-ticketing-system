<div class="container">
  <div class="header-container">
    <button 
      pButton label="Quay lại" icon="pi pi-arrow-left" 
      class="p-button-success mb-2 back-button" 
      [routerLink]="['/admin/order']" routerLinkActive="active">
    </button>
    <h2 class="ticket-title">Danh sách vé đã mua</h2>
  </div>

  <div class="button-search-container">
    <div class="search-container">
      <input
        class="form-control"
        placeholder="Tìm kiếm tên người dùng"
        [(ngModel)]="search"
        name="search"
        (keyup)="onSearch()"
      />
    </div>
    <td><button pButton icon="pi pi-file-pdf" class="p-button-rounded p-button-info mr-2" (click)="exportPdf()"></button></td>
  </div>

  <p-table
    [value]="tickets"
    [tableStyle]="{ 'min-width': '60rem' }"
    [customSort]="false"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id" style="width: 10%">
          Id <p-sortIcon field="id" />
        </th>
        <th>Thông tin người dùng</th>
        <th>Giá tiền</th>
        <th>Thông tin chuyến tàu</th>
        <th>Ghế ngồi</th>
        <th>Ngày mua</th>
        <th>Trạng thái</th>
        <!-- <th>Hành động</th>  -->
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-ticket>
      <tr>
        <td>{{ ticket.id }}</td>
        <td>
          <strong>CMND:</strong> {{ ticket.cmnd }}<br>
          <strong>Tên:</strong> {{ ticket.fullName }}
        </td>
        <td>
          <strong>Khuyến mãi:</strong> {{ ticket.objectDiscount }}<br>
          <strong>Giá gốc:</strong> {{ ticket.price }}<br>
          <strong>Giá giảm:</strong> {{ ticket.priceDiscount }}
        </td>
        <td>
          <strong>Ngày bắt đầu:</strong> {{ ticket.schedule.startDate }}<br>
          <strong>Ngày kết thúc:</strong> {{ ticket.schedule.endDate }}<br>
          <strong>Ga bắt đầu:</strong> {{ ticket.schedule.route.startStation.name }}<br>
          <strong>Ga kết thúc:</strong> {{ ticket.schedule.route.endStation.name }}
          
        </td>
        <td>
          <strong>Tàu:</strong> {{ ticket.schedule.train.name }}<br>
          <strong>Toa:</strong> {{ ticket.seat.carriage.name }}<br>
          <strong>Ghế:</strong> {{ ticket.seatName }}
        </td>
        <td>{{ ticket.dateBuy }}</td>
        <td>{{ ticket.status }}</td>
        
      </tr>
    </ng-template>
  </p-table>

  <div class="card flex justify-content-center mt-3">
    <p-paginator
      [first]="(pageNumber - 1) * pageSize || 0"
      [rows]="pageSize"
      [totalRecords]="total || 0"
      [rowsPerPageOptions]="[5, 10, 20]"
      (onPageChange)="onPageChange($event)"
    >
    </p-paginator>
  </div>
</div>
